# 010 - 프롬프트 목록 페이지 구현

## 1. 목표 (Goal)
- `/prompts` 경로에 마켓플레이스 메인 목록 페이지 구현
- 카테고리 필터, 정렬, 검색 기능 제공
- 재사용 가능한 `PromptCard` 컴포넌트 분리
- "더 보기" 방식의 페이지네이션 적용

## 2. 추론 및 결정 (Reasoning & Decisions)

### PromptCard 컴포넌트 설계
- `components/features/prompt/PromptCard.tsx`에 독립 컴포넌트로 분리
- props로 `PromptWithSeller` 타입을 받아 판매자 정보까지 한 번에 표시
- 카드 전체를 `Link`로 감싸서 클릭 시 상세 페이지(`/prompts/[id]`)로 이동
- hover 시 그림자 + Y축 이동 + 제목 색상 변경 애니메이션
- `line-clamp-2`로 제목/설명 2줄 제한

### 서버 vs 클라이언트 렌더링
- 필터/정렬/검색 상태가 빈번하게 변경되므로 클라이언트 컴포넌트(`'use client'`)로 구현
- 초기 렌더링 시 스켈레톤 UI(animate-pulse)로 로딩 상태 표시
- 향후 SEO가 필요하면 서버 컴포넌트로 초기 데이터를 fetch하고, 필터만 클라이언트에서 처리하는 방식으로 전환 가능

### Supabase JOIN 쿼리
- `select('*, seller:users!seller_id(id, nickname, avatar_url, tier)')` 사용
- Foreign Key 관계를 활용한 서버사이드 JOIN으로 N+1 문제 없이 단일 쿼리로 해결
- `count: 'exact'` 옵션으로 총 개수도 함께 조회

### 페이지네이션: "더 보기" 방식
- 무한 스크롤 대비 사용자 제어 가능, 구현 단순
- `PAGE_SIZE = 12` (4열 기준 3행)
- `range(from, to)` 메서드로 offset 기반 페이징
- 결과가 PAGE_SIZE 미만이면 "더 보기" 버튼 숨김

### 검색 구현
- `or()` 필터로 제목과 설명을 동시에 `ilike` 검색
- 검색 폼은 별도 submit 이벤트로 처리 (입력 중 실시간 쿼리 방지)
- 검색어 활성 시 Badge로 표시하고 x 버튼으로 개별 해제 가능

### 정렬 옵션
- 최신순 (`created_at DESC`) — 기본값
- 인기순 (`purchase_count DESC`)
- 가격 낮은순 (`price ASC`)
- 가격 높은순 (`price DESC`)

### 카테고리 필터
- "전체" + 7개 카테고리 (WRITING~ETC)
- 기존 `CATEGORIES` 상수 배열을 그대로 활용
- 필터 변경 시 자동으로 page 0으로 리셋

## 3. 구현 상세 (Implementation Details)

### 3-1. 추가된 파일

| 파일 | 설명 |
|------|------|
| `components/features/prompt/PromptCard.tsx` | 프롬프트 카드 컴포넌트 |
| `app/prompts/page.tsx` | 프롬프트 목록 페이지 |

### 3-2. PromptCard 레이아웃

```
┌─────────────────────────────┐
│  [카테고리]          [가격]  │
│                             │
│  제목 (최대 2줄)             │
│  설명 (최대 2줄)             │
│  #태그1 #태그2 #태그3 +N    │
│                             │
│  [아바타] 닉네임 🥉  👁 1.2K 🛒 45 │
│  3일 전                      │
└─────────────────────────────┘
```

### 3-3. 목록 페이지 구조

```
┌──────────────────────────────────────────┐
│ [아이콘] 프롬프트 마켓                     │
│          N개의 프롬프트                    │
├──────────────────────────────────────────┤
│ [🔍 검색 입력]                    [검색]  │
│ [⚙ 카테고리 ▼] [정렬 ▼]  [필터 초기화]    │
│ 검색: "키워드" ×                          │
├──────────────────────────────────────────┤
│ ┌────┐ ┌────┐ ┌────┐ ┌────┐             │
│ │Card│ │Card│ │Card│ │Card│             │
│ └────┘ └────┘ └────┘ └────┘             │
│ ┌────┐ ┌────┐ ┌────┐ ┌────┐             │
│ │Card│ │Card│ │Card│ │Card│             │
│ └────┘ └────┘ └────┘ └────┘             │
├──────────────────────────────────────────┤
│              [더 보기]                    │
└──────────────────────────────────────────┘
```

### 3-4. 반응형 그리드

- `xl` (1280px+): 4열
- `lg` (1024px+): 3열
- `sm` (640px+): 2열
- 모바일: 1열

### 3-5. 빈 상태 & 로딩 처리

- **로딩 중**: 8개의 스켈레톤 카드 (animate-pulse)
- **결과 없음 (필터 활성)**: "필터 조건을 변경해보세요"
- **결과 없음 (기본)**: "첫 번째 프롬프트를 등록해보세요!"

## 4. 기존 인프라 활용

| 기존 코드 | 활용 |
|-----------|------|
| `PromptWithSeller` 타입 | JOIN 결과 타입 (seller 정보 포함) |
| `CATEGORIES` 배열 | 카테고리 필터 옵션 |
| `ROUTES.PROMPT_DETAIL(id)` | 카드 클릭 시 이동 경로 |
| `formatPoints()` | 가격 표시 |
| `formatRelativeTime()` | 등록 시간 표시 |
| `formatCompactNumber()` | 조회수/판매수 축약 |
| `TIERS` | 판매자 등급 뱃지 표시 |
| `supabase` 클라이언트 | 데이터 조회 |

## 5. 다음 단계 (Next Steps)

- **011 - 프롬프트 상세 페이지**: `/prompts/[id]` 동적 라우트, 미리보기/구매 버튼
- **012 - 구매 로직**: 포인트 차감/지급, 구매 기록 생성
- **013 - 프로필 & 구매 내역**: 마이페이지, 내 프롬프트 관리
